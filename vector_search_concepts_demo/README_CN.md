# 向量搜索概念演示

本项目演示了使用 Langchain 和 FAISS 进行向量搜索的三个关键概念:

1.  **过滤向量搜索**:展示如何根据与文档关联的元数据过滤向量搜索结果。这允许更精确和有针对性的搜索。
2.  **自查询向量搜索**:说明如何使用语言模型(OpenAI LLM)解析自然语言查询并自动将过滤器应用于向量搜索。这使得搜索过程对用户来说更加直观。
3.  **查询扩展**:演示使用 LLM 生成替代查询的查询扩展,以扩大搜索范围并提高召回率。

## 设置

1.  **创建虚拟环境(推荐):**
    ```bash
    python -m venv venv
    source venv/bin/activate  # 在 Linux/macOS 上
    venv\\Scripts\\activate  # 在 Windows 上
    ```

2.  **安装依赖项:**
    ```bash
    pip install -r requirements.txt
    ```

3.  **设置 OpenAI API 密钥:**
    确保您拥有 OpenAI API 密钥并将其设置为环境变量:`OPENAI_API_KEY=your_api_key`。您也可以将其放在项目根目录的 `.env` 文件中。

## 运行演示

执行 `vector_search.py` 脚本:

```bash
python vector_search_concepts_demo/vector_search.py
```

该脚本将:

*   使用示例文档(服装和家具项目)初始化 FAISS 向量存储。
*   通过示例查询演示三个向量搜索概念中的每一个。
*   将每种搜索类型的结果和延迟记录到控制台。

## 概念解释

### 1. 过滤向量搜索

过滤向量搜索允许您将语义相似性搜索与元数据过滤器结合起来。当您想将搜索结果缩小到特定类别或基于某些属性时,这非常有用。

**示例:** 搜索“服装”,但只希望结果是“蓝色”的。

### 2. 自查询向量搜索

自查询向量搜索通过允许自然语言查询来增强用户体验。使用语言模型来理解查询,识别查询中提到的过滤器,然后自动执行过滤向量搜索。

**示例:** 询问“显示蓝色服装商品”。系统理解搜索服装并按颜色“蓝色”过滤的意图。

### 3. 查询扩展

查询扩展旨在通过扩大搜索查询来提高召回率。这是通过使用 LLM 生成替代查询来完成的。

**示例:** 如果用户搜索“办公家具”,系统会生成替代查询以确保不会遗漏相关文档。

## 性能注意事项

该脚本记录每种搜索类型的延迟。在实际应用中:

*   **延迟**:向量搜索延迟通常非常低。过滤搜索可能会增加轻微的开销,但仍然非常快。自查询和查询扩展延迟将包括语言模型花费的时间。
*   **召回率和精确率**:
    *   **基本向量搜索**:对于语义相似的文档具有良好的召回率,但如果查询范围广泛,则可能包含不相关的结果。
    *   **过滤向量搜索**:通过缩小结果范围来提高精确率,如果过滤器过于严格,可能会降低召回率。
    *   **自查询向量搜索**:旨在通过根据用户意图智能地应用过滤器来平衡召回率和精确率。
    *   **查询扩展**:旨在提高召回率,但如果查询扩展过于广泛,则可能会降低精确率。

此演示提供了这些概念的基本说明。需要进一步的实验和微调来优化特定用例的性能。